(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{5188:(e,t,n)=>{Promise.resolve().then(n.bind(n,7657))},7657:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var a=n(5155),o=n(9564),r=n(2115),l=n(5695);function c(){let{user:e}=(0,o.A)();if(!e)return null;e.role}function s(){let{user:e,loading:t}=(0,o.A)(),n=(0,l.useRouter)();return((0,r.useEffect)(()=>{t||e||n.replace("/login")},[e,t,n]),t||!e)?(0,a.jsx)("div",{className:"p-10 text-center",children:"Loading..."}):(0,a.jsx)(c,{})}},9564:(e,t,n)=>{"use strict";n.d(t,{AuthProvider:()=>s,A:()=>u});var a=n(5155),o=n(2115);let r=n(3464).A.create({baseURL:"https://back.roshandevkota.com.np",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});r.interceptors.request.use(e=>{let t=function(){let e=window.location.hostname,t="office.roshandevkota.com.np";return e===t?"":("a.roshandevkota.com.np,b.roshandevkota.com.np".split(",")||[]).includes(e)?e.replace(".".concat(t),"").split(".")[0]:""}();t&&e.url&&!e.url.startsWith("/".concat(t,"/"))&&(e.url="/".concat(t).concat(e.url.startsWith("/")?"":"/").concat(e.url));{let t=function(e){if("undefined"==typeof document)return null;let t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():null}("XSRF-TOKEN");t&&(e.headers["X-XSRF-TOKEN"]=decodeURIComponent(t))}return e});var l=n(5695);let c=(0,o.createContext)(void 0);function s(e){let{children:t}=e,[n,s]=(0,o.useState)(null),[u,i]=(0,o.useState)(!0),d=(0,l.useRouter)(),p=(0,l.usePathname)();(0,o.useEffect)(()=>{if(p){if("/login"===p)return void i(!1);(async()=>{try{let e=await r.get("/me");s(e.data)}catch(e){s(null)}finally{i(!1)}})()}},[p]);let h=async(e,t)=>{i(!0);try{let n;await r.get("/sanctum/csrf-cookie"),await r.post("/login",{email:e,password:t});let a=await r.get("/me");s(a.data),d.replace("/")}catch(e){throw s(null),e}finally{i(!1)}},f=async()=>{try{await r.post("/logout")}catch(e){}localStorage.removeItem("token"),s(null),d.replace("/login")};return(0,a.jsx)(c.Provider,{value:{user:n,loading:u,login:h,logout:f},children:t})}function u(){let e=(0,o.useContext)(c);if(!e)throw Error("useAuth must be inside AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[794,441,684,358],()=>t(5188)),_N_E=e.O()}]);