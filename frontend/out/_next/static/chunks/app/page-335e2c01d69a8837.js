(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{220:(e,t,o)=>{Promise.resolve().then(o.bind(o,1057))},1057:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>c});var a=o(5155),n=o(5731),r=o(2115),l=o(5695);function c(){let{user:e,loading:t}=(0,n.A)(),o=(0,l.useRouter)();return(0,r.useEffect)(()=>{t||(e?o.replace("/dashboard"):o.replace("/login"))},[e,t,o]),(0,a.jsx)("div",{className:"p-10 text-center",children:"Loading..."})}},4871:(e,t,o)=>{"use strict";o.d(t,{A:()=>n});let a=o(3464).A.create({baseURL:"https://back.roshandevkota.com.np",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});a.interceptors.request.use(e=>{let t=function(){let e=window.location.hostname,t="office.roshandevkota.com.np";return e===t?"":("a.roshandevkota.com.np,b.roshandevkota.com.np".split(",")||[]).includes(e)?e.replace(".".concat(t),"").split(".")[0]:""}();t&&e.url&&!e.url.startsWith("/".concat(t,"/"))&&(e.url="/".concat(t).concat(e.url.startsWith("/")?"":"/").concat(e.url));{let t=function(e){if("undefined"==typeof document)return null;let t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():null}("XSRF-TOKEN");console.log("XSRF-TOKEN from cookie:",t),t&&(console.log("Using XSRF-TOKEN from cookie:",t),e.headers["X-XSRF-TOKEN"]=decodeURIComponent(t))}return e});let n=a},5731:(e,t,o)=>{"use strict";o.d(t,{A:()=>i,AuthProvider:()=>s});var a=o(5155),n=o(2115),r=o(4871),l=o(5695);let c=(0,n.createContext)(void 0);function s(e){let{children:t}=e,[o,s]=(0,n.useState)(null),[i,u]=(0,n.useState)(!0),[d,h]=(0,n.useState)(()=>localStorage.getItem("authMode")||"cookie"),p=(0,l.useRouter)(),f=(0,l.usePathname)();(0,n.useEffect)(()=>{localStorage.setItem("authMode",d)},[d]),(0,n.useEffect)(()=>{if(f){if("/login"===f)return void u(!1);(async()=>{try{if("token"===d&&!localStorage.getItem("token"))throw Error("No token");let e=await r.A.get("/me");s(e.data)}catch(e){s(null)}finally{u(!1)}})()}},[f,d]);let m=async(e,t)=>{u(!0);try{let o;"token"===d?(o=await r.A.post("/login",{email:e,password:t})).data.token&&localStorage.setItem("token",o.data.token):(await r.A.get("/sanctum/csrf-cookie"),o=await r.A.post("/login",{email:e,password:t}));let a=await r.A.get("/me");s(a.data),p.replace("/")}catch(e){throw s(null),e}finally{u(!1)}},k=async()=>{try{await r.A.post("/logout")}catch(e){}localStorage.removeItem("token"),s(null),p.replace("/login")};return(0,a.jsx)(c.Provider,{value:{user:o,loading:i,authMode:d,setAuthMode:h,login:m,logout:k},children:t})}function i(){let e=(0,n.useContext)(c);if(!e)throw Error("useAuth must be inside AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[794,441,684,358],()=>t(220)),_N_E=e.O()}]);