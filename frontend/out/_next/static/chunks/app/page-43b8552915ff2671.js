(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{220:(t,e,a)=>{Promise.resolve().then(a.bind(a,1057))},1057:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>l});var o=a(5155),n=a(5731),r=a(2115),c=a(5695);function l(){let{user:t,loading:e}=(0,n.A)(),a=(0,c.useRouter)();return(0,r.useEffect)(()=>{e||(t?a.replace("/dashboard"):a.replace("/login"))},[t,e,a]),(0,o.jsx)("div",{className:"p-10 text-center",children:"Loading..."})}},4871:(t,e,a)=>{"use strict";a.d(e,{A:()=>n});let o=a(3464).A.create({baseURL:"https://back.roshandevkota.com.np",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});o.interceptors.request.use(t=>{let e=t.url||"",a=function(){let t=window.location.hostname,e="office.roshandevkota.com.np";return t===e?"":("a.roshandevkota.com.np,b.roshandevkota.com.np".split(",")||[]).includes(t)?t.replace(".".concat(e),"").split(".")[0]:""}();!a||e.startsWith("/".concat(a,"/"))||e.startsWith("/api/")||(e="/".concat(a).concat(e.startsWith("/")?"":"/").concat(e)),t.url=e;{let e=function(t){var e;if("undefined"==typeof document)return null;let a=document.cookie.match("(^|;)\\s*"+t+"\\s*=\\s*([^;]+)");return a&&null!=(e=a.pop())?e:null}("XSRF-TOKEN");e&&t.headers&&(t.headers["X-XSRF-TOKEN"]=decodeURIComponent(e))}return t});let n=o},5731:(t,e,a)=>{"use strict";a.d(e,{A:()=>i,AuthProvider:()=>s});var o=a(5155),n=a(2115),r=a(4871),c=a(5695);let l=(0,n.createContext)(void 0);function s(t){let{children:e}=t,[a,s]=(0,n.useState)(null),[i,u]=(0,n.useState)(!0),[d,h]=(0,n.useState)(()=>localStorage.getItem("authMode")||"cookie"),p=(0,c.useRouter)(),f=(0,c.usePathname)();(0,n.useEffect)(()=>{localStorage.setItem("authMode",d)},[d]),(0,n.useEffect)(()=>{if(f){if("/login"===f)return void u(!1);(async()=>{try{if("token"===d&&!localStorage.getItem("token"))throw Error("No token");let t=await r.A.get("/me");s(t.data)}catch(t){s(null)}finally{u(!1)}})()}},[f,d]);let m=async(t,e)=>{u(!0);try{let a;"token"===d?(a=await r.A.post("/login",{email:t,password:e})).data.token&&localStorage.setItem("token",a.data.token):(await r.A.get("/sanctum/csrf-cookie"),a=await r.A.post("/login",{email:t,password:e}));let o=await r.A.get("/me");s(o.data),p.replace("/")}catch(t){throw s(null),t}finally{u(!1)}},k=async()=>{try{await r.A.post("/logout")}catch(t){}localStorage.removeItem("token"),s(null),p.replace("/login")};return(0,o.jsx)(l.Provider,{value:{user:a,loading:i,login:m,logout:k},children:e})}function i(){let t=(0,n.useContext)(l);if(!t)throw Error("useAuth must be inside AuthProvider");return t}}},t=>{var e=e=>t(t.s=e);t.O(0,[794,441,684,358],()=>e(220)),_N_E=t.O()}]);