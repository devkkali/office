(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{6453:(e,t,a)=>{Promise.resolve().then(a.bind(a,9802))},9564:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>i,A:()=>u});var l=a(5155),n=a(2115);let r=a(3464).A.create({baseURL:"https://back.roshandevkota.com.np",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});r.interceptors.request.use(e=>{let t=function(){let e=window.location.hostname,t="office.roshandevkota.com.np";return e===t?"":("a.roshandevkota.com.np,b.roshandevkota.com.np".split(",")||[]).includes(e)?e.replace(".".concat(t),"").split(".")[0]:""}();return t&&e.url&&!e.url.startsWith("/".concat(t,"/"))&&(e.url="/".concat(t).concat(e.url)),e});var s=a(5695);let o=(0,n.createContext)(void 0);function i(e){let{children:t}=e,[a,i]=(0,n.useState)(null),[u,c]=(0,n.useState)(!0),d=(0,s.useRouter)(),p=(0,s.usePathname)();(0,n.useEffect)(()=>{if("/login"===p)return void c(!1);(async()=>{try{let e=await r.get("/api/me");i(e.data)}catch(e){i(null)}finally{c(!1)}})()},[p]);let h=async(e,t)=>{c(!0);try{let a;await r.get("/sanctum/csrf-cookie"),await r.post("/api/login",{email:e,password:t});let l=await r.get("/api/me");i(l.data),d.replace("/")}catch(e){throw e}finally{c(!1)}},m=async()=>{try{await r.post("/api/logout")}catch(e){}localStorage.removeItem("token"),i(null),d.replace("/login")};return(0,l.jsx)(o.Provider,{value:{user:a,loading:u,login:h,logout:m},children:t})}function u(){let e=(0,n.useContext)(o);if(!e)throw Error("useAuth must be inside AuthProvider");return e}},9802:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var l=a(5155),n=a(9564),r=a(2115),s=a(5695);function o(){let{login:e,loading:t}=(0,n.A)(),[a,s]=(0,r.useState)(""),[o,i]=(0,r.useState)(""),[u,c]=(0,r.useState)(null),d=async t=>{t.preventDefault(),c(null);try{await e(a,o)}catch(e){var l,n;c((null==e||null==(n=e.response)||null==(l=n.data)?void 0:l.message)||"Login failed")}};return(0,l.jsxs)("div",{className:"max-w-sm mx-auto my-24 p-8 rounded-2xl bg-white shadow-xl",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-6 text-blue-800",children:"Login"}),(0,l.jsxs)("form",{onSubmit:d,children:[(0,l.jsx)("input",{className:"mb-4 w-full px-4 py-2 border rounded",type:"email",placeholder:"Email",value:a,onChange:e=>s(e.target.value),required:!0}),(0,l.jsx)("input",{className:"mb-4 w-full px-4 py-2 border rounded",type:"password",placeholder:"Password",value:o,onChange:e=>i(e.target.value),required:!0}),(0,l.jsx)("button",{className:"w-full py-2 rounded bg-blue-700 text-white font-semibold",type:"submit",disabled:t,children:t?"Logging in...":"Login"}),u&&(0,l.jsx)("div",{className:"mt-3 text-red-600 text-sm",children:u})]})]})}function i(){let{user:e,loading:t}=(0,n.A)(),a=(0,s.useRouter)();return((0,r.useEffect)(()=>{!t&&e&&a.replace("/")},[e,t,a]),t)?(0,l.jsx)("div",{className:"p-10 text-center",children:"Loading..."}):(0,l.jsx)(o,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[794,441,684,358],()=>t(6453)),_N_E=e.O()}]);